# **ä»‹ç»**

## ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ RxSwift ï¼Ÿ

æˆ‘ä»¬ç¼–å†™çš„ç»å¤§å¤šæ•°ä»£ç éƒ½æ¶‰åŠå“åº”å¤–éƒ¨äº‹ä»¶ã€‚å½“ç”¨æˆ·æ“ä½œæ§ä»¶æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ª `@IBAction` æ¥å¤„ç†ç¨‹åºå“åº”ã€‚ æˆ‘ä»¬éœ€è¦è§‚å¯Ÿé€šçŸ¥ä»¥æ£€æµ‹é”®ç›˜ä½•æ—¶æ”¹å˜ä½ç½®ã€‚å½“ URL ä¼šè¯å“åº”æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æä¾›é—­åŒ…æ¥æ‰§è¡Œã€‚æˆ‘ä»¬ä½¿ç”¨ KVO æ¥æ£€æµ‹å˜é‡çš„å˜åŒ–ã€‚æ‰€æœ‰è¿™äº›ä¸åŒçš„ç³»ç»Ÿä½¿æˆ‘ä»¬çš„ä»£ç å˜å¾—ä¸å¿…è¦å¤æ‚ã€‚å¦‚æœæœ‰ä¸€ä¸ªä¸€è‡´çš„ç³»ç»Ÿå¤„ç†æˆ‘ä»¬æ‰€æœ‰çš„å›è°ƒã€å“åº”ä»£ç ï¼Œé‚£ä¸æ˜¯æ›´å¥½å—ï¼Ÿ Rx å°±æ˜¯è¿™æ ·ä¸€ä¸ªç³»ç»Ÿã€‚

## æ¦‚å¿µ

**æ¯ä¸ª `Observable` å®ä¾‹éƒ½åªæ˜¯ä¸€ä¸ªåºåˆ—ã€‚**

`Observable` åºåˆ—ä¸ Swift çš„ `Sequence` å…³é”®ä¼˜åŠ¿åœ¨äºå®ƒè¿˜å¯ä»¥å¼‚æ­¥æ¥æ”¶å…ƒç´ ã€‚*è¿™æ˜¯ RxSwift çš„ç²¾é«“* ã€‚å…¶ä»–ä¸€åˆ‡éƒ½æ‰©å±•åˆ°äº†è¿™ä¸ªæ¦‚å¿µã€‚

- `Observable` ( `ObservableType` ) ç­‰åŒäº `Sequence` ï¼›
- `ObservableType.subscribe(_:)` æ–¹æ³•ç­‰åŒäº `Sequence.makeIterator()` ï¼›
- `ObservableType.subscribe(_:)` æ¥å—ä¸€ä¸ªè§‚å¯Ÿè€… ( `ObserverType` ) å‚æ•°ï¼Œè¯¥å‚æ•°å°†è¢«è®¢é˜…ä»¥è‡ªåŠ¨æ¥æ”¶ `Observable` å‘å‡ºçš„åºåˆ—äº‹ä»¶å’Œå…ƒç´ ã€‚

å¦‚æœ `Observable` å‘å‡ºä¸‹ä¸€ä¸ªäº‹ä»¶ ( `Event.next(Element)` ) ï¼Œå®ƒå¯ä»¥ç»§ç»­å‘å‡ºæ›´å¤šäº‹ä»¶ã€‚ä½†æ˜¯ï¼Œå¦‚æœ `Observable` å‘å‡ºé”™è¯¯äº‹ä»¶ ( `Event.error(ErrorType)` ) æˆ–å·²å®Œæˆäº‹ä»¶ ( `Event.completed` ) ï¼Œåˆ™ `Observable` åºåˆ—æ— æ³•å‘è®¢é˜…è€…å‘å‡ºå…¶ä»–äº‹ä»¶ã€‚

åºåˆ—è¯­æ³•æ›´ç®€æ´åœ°è§£é‡Šäº†è¿™ä¸€ç‚¹ï¼š

`next* (error | completed)?`

è¿™ä¹Ÿå¯ä»¥ä½¿ç”¨å›¾è¡¨æ›´ç›´è§‚åœ°è§£é‡Šï¼š

```swift
--1--2--3--4--5--6--|----> // "|" = æ­£å¸¸ç»ˆæ­¢

--a--b--c--d--e--f--X----> // "X" = é”™è¯¯ç»ˆæ­¢

--tap--tap----------tap--> // "|" = æ— é™æœŸåœ°ç»§ç»­ï¼Œä¾‹å¦‚ä¸€ç³»åˆ—æŒ‰é’®ç‚¹å‡»
```

> <font color=orange>**æ³¨æ„**</font>
>
> è¿™äº›å›¾è¢«ç§°ä¸º[å¤§ç†çŸ³å›¾](https://rxmarbles.com/)ã€‚

### <font color=gray>è¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€… ( åˆç§°è®¢é˜…è€… )</font>

é™¤éæœ‰è®¢é˜…è€…ï¼Œå¦åˆ™ `Observable` å°†ä¸ä¼šæ‰§è¡Œå…¶è®¢é˜…é—­åŒ…ã€‚åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œå°†æ°¸è¿œä¸ä¼šæ‰§è¡Œ `Observable` çš„é—­åŒ…ï¼Œå› ä¸ºæ²¡æœ‰è®¢é˜…è€…ï¼š

```swift
_ = Observable<String>.create { observerOfString -> Disposable in
    print("æ°¸è¿œä¸ä¼šæ‰“å°å‡ºæ¥")
    observerOfString.on(.next("ğŸ˜¬"))
    observerOfString.on(.completed)
    return Disposables.create()
}
```

åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œå°†åœ¨è°ƒç”¨ `subscribe(_:)` æ—¶æ‰§è¡Œé—­åŒ…ï¼š

```swift
_ = Observable<String>.create { observerOfString in
    print("Observable created")
    observerOfString.on(.next("ğŸ˜‰"))
    observerOfString.on(.completed)
    return Disposables.create()
}.subscribe { event in
    print(event)
}
```

> <font color=orange>**æ³¨æ„**</font>
>
> ä¸è¦å…³å¿ƒåœ¨è¿™äº›ç¤ºä¾‹ä¸­å¦‚ä½•åˆ›å»ºè¿™äº› `Observable` çš„ç»†èŠ‚ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥ä¼šè¿›å…¥[ä¸‹ä¸€é¡µ](02. åˆ›å»ºå’Œè®¢é˜… Observable.md)ã€‚

> <font color=orange>**æ³¨æ„**</font>
>
> `subscribe(_:)` è¿”å›è¡¨ç¤ºå¯æ”¯é…èµ„æº ( å¦‚è®¢é˜… ) çš„ `Disposable` å®ä¾‹ã€‚ åœ¨ä¹‹å‰çš„ç®€å•ç¤ºä¾‹ä¸­å¿½ç•¥äº†å®ƒï¼Œä½†é€šå¸¸åº”è¯¥æ­£ç¡®å¤„ç†å®ƒã€‚è¿™é€šå¸¸æ„å‘³ç€å°†å…¶æ·»åŠ åˆ° `DisposeBag` å®ä¾‹ã€‚æ¥ä¸‹æ¥çš„æ‰€æœ‰ä¾‹å­éƒ½å°†åŒ…æ‹¬é€‚å½“çš„å¤„ç†ï¼Œå› ä¸ºï¼Œå®è·µä½¿ *æ°¸ä¹…* ğŸ™‚ã€‚ æ‚¨å¯ä»¥åœ¨ [å…¥é—¨æŒ‡å—](https://github.com/ReactiveX/RxSwift/blob/master/Documentation/GettingStarted.md) çš„ [Disposing](https://github.com/ReactiveX/RxSwift/blob/master/Documentation/GettingStarted.md#disposing) éƒ¨åˆ†äº†è§£æœ‰å…³æ­¤å†…å®¹çš„æ›´å¤šä¿¡æ¯ã€‚